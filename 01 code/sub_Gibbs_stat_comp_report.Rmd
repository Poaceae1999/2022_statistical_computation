---
title: "Gibbs"
author: "ZJH"
date: "`r Sys.Date()`"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# init
```{r,init}
library(assertthat)
library(invgamma)
library(LearnBayes)
data("birthweight")
library(lattice)
library(boa)
library(coda)
```

# distributions
```{r}
dinvgamma <- function(x,shape,scale){
  fx <- (scale^shape*exp(-scale/x)*x^(-shape-1))/gamma(shape)
  return(fx)}
Cauchy_plus <- function(x,b_cauchy){
  assert_that(b_cauchy>0)
  fx <- 2/pi/(b_cauchy*(1+(x/b_cauchy)^2)*(x>0))
  return(fx)
}
prob <- function(x,shape,scale,b_cauchy){
  fx <- dinvgamma(x^2,shape =shape,scale=scale)*Cauchy_plus(x,b_cauchy=b_cauchy)*7.3
  return(fx)
}

```

# functions
# gogogo
# parameters for model
```{r}
n1 <- sum(birthweight$gender==0)
n2 <- sum(birthweight$gender==1)

```

# full conditionals
```{r}
# mu1
p_mu1 <- function(eta,sigma,tau,y1j) { 
  fx <- rnorm(n = 1,
              mean = (1/((sigma^2)/n1) + 1/tau^2)
              *(mean(y1j)/(sigma^2/n1)+eta/tau^2) ,
              sd = (1/(sigma^2/n1)+1/tau^2)^(-0.5)
  )
  return(fx)
  }
p_mu2 <- function(eta,sigma,tau,y2j) { 
  fx <- rnorm(n = 1,
              mean = (1/((sigma^2)/n2) + 1/tau^2)
              *(mean(y2j)/(sigma^2/n2)+eta/tau^2) ,
              sd = (1/(sigma^2/n2)+1/tau^2)^(-0.5))
  return(fx)
  }
p_eta <- function(mu1,mu2,tau) { 
  fx <- rnorm(n = 1,
              mean = mean(mu1,mu2),
              sd = ((tau^2)/2)^0.5)
  return(fx)}
p_sigma <- function(eta,sigma,tau,y1j,y2j,mu1,mu2) {
  fx <- rinvgamma(n = 1,
                     shape = mean(n1,n2),
                     scale = sum((y1j-mu1)^2 + (y2j-mu2)^2)) * Cauchy_plus(0,b_sigma)
  return(fx)  }

p_tau <- function(eta,mu1,mu2) { 
  fx <- rinvgamma(n = 1,
                     shape = 1,
                     scale = mean((mu1-eta)^2, 
                                  (mu2-eta)^2))*Cauchy_plus(0,b_tau)
  return(fx)
  }
                     
```

```{r}

```

