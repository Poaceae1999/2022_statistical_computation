---
title: "sub_condition_two|stat_comp_report"
author: "ZJH"
date: "`r Sys.Date()`"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# init
```{r,init}
library(MyToolBox)
library(assertthat)
library(invgamma)
library(LearnBayes)
data("birthweight")
library(lattice)
mygender <- with(birthweight, ifelse(birthweight$gender==0,"Male","Female"))
dotplot(mygender ~ weight, data = birthweight,
xlab = "Birthweight", ylab = "Gender")
```

# distributions
```{r}
dinvgamma <- function(x,shape,scale){
  fx <- (scale^shape*exp(-scale/x)*x^(-shape-1))/gamma(shape)
  return(fx)}
Cauchy_plus <- function(x,b_cauchy){
  assert_that(b_cauchy>0)
  fx <- 2/pi/(b_cauchy*(1+(x/b_cauchy)^2)*(x>0))
  return(fx)
}
target_dist <- function(x,shape,scale,b_cauchy){
  fx <- dinvgamma(x^2,shape =shape,scale=scale)*Cauchy_plus(x,b_cauchy=b_cauchy)
  return(fx)
}
```

# functions
Independent Metropolis Hastings 
```{r}

```

# gogogo
# parameters for model
```{r}
b_tau <- 1# i don't know what actually is,for cauchy plus(0,b_tau)
a <- 1 # for proposal distribution inverse gamma(a,b) 
b <- 1 # for proposal distribution inverse gamma(a,b)
```
# parameters for simulation process
```{r}
m <- 10000 #length of chain
xt <- numeric(m)
n <- 30 #sample size
# generate the observed sample
x <- rinvgamma(n,shape = a,scale = b)

# generate the independence sampler chain
u <- runif(m)
y <- rinvgamma(m,shape = a,scale = b) #proposal distribution
xt[1] <- 1
for (i in 2:m) {
  fy <- Cauchy_plus(x = y[i],b_cauchy = b_tau)
  fx <- Cauchy_plus(x = xt[i-1],b_cauchy = b_tau)
  r <- prod(fy / fx) *
    dinvgamma(xt[i-1],shape = a,scale = b) /
    dinvgamma(y[i],shape = a,scale = b)
  if (u[i] <= r){
    xt[i] <- y[i] 
  }else 
  {
    xt[i] <- xt[i-1]
  }
}
```

```{r}
draw(Cauchy_plus,xt[1000:m] %>% sort() %>% head(8500,),b_cauchy = b_tau)
```

